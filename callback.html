<!DOCTYPE html>
<html>
<body>
<script>
  const params = new URLSearchParams(location.hash.substring(1));
  const token = params.get("access_token");

  if (token) {
    localStorage.setItem("twitch_token", token);
  }

  fetch("https://api.twitch.tv/helix/users", {
    headers: {
      "Authorization": `Bearer ${token}`,
      "Client-ID": "あなたのClientID"
    }
  })
  .then(r => r.json())
  .then(data => {
    localStorage.setItem("twitch_username", data.data[0].login);
    location.href = "./index.html";
  });
</script>
</body>
</html>
